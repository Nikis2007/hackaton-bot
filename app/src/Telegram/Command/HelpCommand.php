<?php

declare(strict_types=1);

namespace App\Telegram\Command;

use App\Service\RateLimiter;
use Longman\TelegramBot\Commands\UserCommand;
use Longman\TelegramBot\Entities\ServerResponse;
use Longman\TelegramBot\Request;

/**
 * ÐšÐ¾Ð¼Ð°Ð½Ð´Ð° /help - ÑÐ¿Ñ€Ð°Ð²ÐºÐ° Ð¿Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÑŽ Ð±Ð¾Ñ‚Ð°.
 */
class HelpCommand extends UserCommand
{
    protected $name = 'help';
    protected $description = 'Ð¡Ð¿Ñ€Ð°Ð²ÐºÐ° Ð¿Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÑŽ Ð±Ð¾Ñ‚Ð°';
    protected $usage = '/help';
    protected $version = '1.0.0';

    public function execute(): ServerResponse
    {
        $message = $this->getMessage();
        $chatId = $message->getChat()->getId();

        $config = RateLimiter::getConfig();

        $text = sprintf(<<<TEXT
ðŸ“– Ð¡Ð¿Ñ€Ð°Ð²ÐºÐ° Ð¿Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÑŽ Ð±Ð¾Ñ‚Ð°

ðŸ”¹ ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÐ¼Ñ‹Ðµ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ñ‹:
â€¢ JSON (Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÑ‚ÑÑ) â€” ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ Ð±Ð¾Ð»ÑŒÑˆÐµ Ð´Ð°Ð½Ð½Ñ‹Ñ…
â€¢ HTML â€” Ñ‚Ð°ÐºÐ¶Ðµ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ÑÑ

ðŸ”¹ ÐšÐ°Ðº ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ñ‡Ð°Ñ‚:
1. ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ Telegram Desktop
2. ÐŸÐµÑ€ÐµÐ¹Ð´Ð¸Ñ‚Ðµ Ð² Ð½ÑƒÐ¶Ð½Ñ‹Ð¹ Ñ‡Ð°Ñ‚
3. ÐœÐµÐ½ÑŽ (â‹®) â†’ Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¸ÑÑ‚Ð¾Ñ€Ð¸ÑŽ Ñ‡Ð°Ñ‚Ð°
4. Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ Ð¸ ÑÐ¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚Ðµ

ðŸ”¹ ÐžÐ³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ñ:
â€¢ ÐœÐ°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ€Ð°Ð·Ð¼ÐµÑ€ Ñ„Ð°Ð¹Ð»Ð°: 20 ÐœÐ‘
â€¢ ÐœÐ¾Ð¶Ð½Ð¾ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ Ð´Ð¾ 10 Ñ„Ð°Ð¹Ð»Ð¾Ð² Ð·Ð° Ñ€Ð°Ð·
â€¢ Ð›Ð¸Ð¼Ð¸Ñ‚ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸: %d Ñ„Ð°Ð¹Ð»Ð¾Ð² Ð·Ð° %d ÑÐµÐº. Ð½Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ

ðŸ”¹ Ð§Ñ‚Ð¾ Ð¸Ð·Ð²Ð»ÐµÐºÐ°ÐµÑ‚ÑÑ:
â€¢ ÐÐ²Ñ‚Ð¾Ñ€Ñ‹ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹
â€¢ Ð£Ð¿Ð¾Ð¼Ð¸Ð½Ð°Ð½Ð¸Ñ (@username)
â€¢ ÐÐ²Ñ‚Ð¾Ñ€Ñ‹ Ð¿ÐµÑ€ÐµÑÐ»Ð°Ð½Ð½Ñ‹Ñ… ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹
â€¢ ÐšÐ°Ð½Ð°Ð»Ñ‹ (ÐµÑÐ»Ð¸ ÐµÑÑ‚ÑŒ)

ðŸ”¹ Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚:
â€¢ < 50 ÑƒÑ‡Ð°ÑÑ‚Ð½Ð¸ÐºÐ¾Ð² â†’ ÑÐ¿Ð¸ÑÐ¾Ðº Ð² Ñ‡Ð°Ñ‚
â€¢ â‰¥ 51 ÑƒÑ‡Ð°ÑÑ‚Ð½Ð¸Ðº â†’ Excel-Ñ„Ð°Ð¹Ð» Ñ Ð²ÐºÐ»Ð°Ð´ÐºÐ°Ð¼Ð¸:
  - Ð£Ñ‡Ð°ÑÑ‚Ð½Ð¸ÐºÐ¸
  - Ð£Ð¿Ð¾Ð¼Ð¸Ð½Ð°Ð½Ð¸Ñ
  - ÐšÐ°Ð½Ð°Ð»Ñ‹

ðŸ”¹ ÐšÐ¾Ð½Ñ„Ð¸Ð´ÐµÐ½Ñ†Ð¸Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ:
Ð‘Ð¾Ñ‚ ÐÐ• ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐµÑ‚ Ð²Ð°ÑˆÐ¸ Ñ„Ð°Ð¹Ð»Ñ‹. ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¿Ñ€Ð¾Ð¸ÑÑ…Ð¾Ð´Ð¸Ñ‚ Ð² Ð¿Ð°Ð¼ÑÑ‚Ð¸, Ð´Ð°Ð½Ð½Ñ‹Ðµ ÑƒÐ´Ð°Ð»ÑÑŽÑ‚ÑÑ ÑÑ€Ð°Ð·Ñƒ Ð¿Ð¾ÑÐ»Ðµ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸.

ÐšÐ¾Ð¼Ð°Ð½Ð´Ñ‹:
/start â€” Ð½Ð°Ñ‡Ð°Ñ‚ÑŒ Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ
/help â€” ÑÑ‚Ð° ÑÐ¿Ñ€Ð°Ð²ÐºÐ°
TEXT, $config['maxFiles'], $config['windowSeconds']);

        return Request::sendMessage([
            'chat_id' => $chatId,
            'text' => $text,
        ]);
    }
}
